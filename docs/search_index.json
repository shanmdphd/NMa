[
["index.html", "계량약리학 분석을 위한 NONMEM 사용 매뉴얼- 프로그램 설치 및 실행- 1 계량약리학과 NONMEM", " 계량약리학 분석을 위한 NONMEM 사용 매뉴얼- 프로그램 설치 및 실행- 1 계량약리학과 NONMEM 계량약리학은 약물, 질병, 임상 정보를 종합하여 정량화하여 약물 개발 및 의약품 허가시에 과학적이고 객관적인 판단기준을 제공하기 위한 목적으로 개발되었다. 계량약리학적 접근 방법을 이용하여 약물 노출정도에 따른 약동학적 인자 또는 약력학적 효과에 대하여 환자의 생리학적 특성과의 관계를 밝혀냄으로써 개별 환자에게 적합한 용량을 설정해 낼 수 있다. 계량약리학의 기본 출발은 같은 약물을 복용하여도 환자마다 약물 반응이 다르게 나타나는 원인을 밝혀내는 것이라고 할 수 있다. 약물 반응의 다양성을 일으키는 원인은 연령, 몸무게, 신장기능, 간기능, 민족적 차이, 약물유전형 등의 예측이 가능한 요소가 있을 수 있고 현재의 기술과 정보로는 설명이 어려운 개인 간 차이도 있을 수 있다. 서로 다른 약물반응의 원인이 되는 인자와 약동학적 또는 약물학적 반응과의 상관관계에 대하여 수학적 계산을 통한 모델을 수립하고, 수립된 모델을 시뮬레이션 함으로써 시간에 따른 약물노출-약물반응의 상관관계를 설명하고 개별 환자 또는 특정 환자 그룹에게 적절한 용량을 설정해 내는 것이다. 집단약동학 등 계량약리학 분석의 주된 분석 도구로 사용되는 비선형 혼합효과모델(Nonlinear Mixed Effects Model)은, 집단의 특성이 고정효과(fixed-effects)로부터 도출된 집단값(typical value)과 무작위 효과(random-effects)로부터 얻어진 개인간(inter-individual) 및 개인내(intra-individual) 차이를 반영한 혼합효과 모델로 설명되어 질 수 있다. 계량약리학 연구를 위해 많은 모델링 소프트웨어가 개발되고 있지만, 현재로서는 NONMEM이 가장 널리 사용되고 있다. 하지만 NONMEM은 도스를 기반으로 하는 프로그램으로서 일반인이 쉽게 사용하기 어려우므로, 이를 해결하기 위해 NONMEM외에 PsN, R, Pirana와 같은 여러 프로그램이 개발되어 활용되고 있다. "],
["-.html", "2 프로그램 설치 및 연동 2.1 NONMEM 설치 2.2 PsN 설치 2.3 R 및 R studio 설치 2.4 Pirana 설치 2.5 Pirana에 프로그램 연동", " 2 프로그램 설치 및 연동 NONMEM을 활용한 계량약리학 연구를 위해 필요한 여러 가지 프로그램 중, 여기서는 기본적인 프로그램인 NONMEM, PsN, Pirana, R 및 R studio의 설치 및 구동 방법에 대해 설명하고자 한다. 2.1 NONMEM 설치 NONMEM은 Nonlinear Mixed Effects Model(비선형혼합효과모델)의 이니셜로, 계량약리학 분석에 가장 많이 활용되고 있는 프로그램이다. NONMEM을 사용하기 위해서는 라이선스를 받아야 하며, ICON 사에 메일로 구매 요청하고 대금이 결제되면 라이선스 파일인 license.lic 파일과 password를 받을 수 있다. 라이선스는 1년 단위로 갱신한다. ※ NONMEM 라이선스 요청 이메일 주소: IDSSoftware@iconplc.com 라이선스를 받으면, ICON사의 NONMEM 프로그램 다운받는 사이트로 들어가서, 설치할 컴퓨터의 사양에 맞는 설치파일을 다운로드한다. 2.1.1 Windows에서 설치 윈도우즈 운영체계가 32비트인 경우에는 ‘nonmem730_gfortran460.exe’, 64비트는 ‘nonmem730_64gfortran463.exe’를 다운받는다. (그림 1) ※ NONMEM 프로그램 사이트 : https://nonmem.iconplc.com ※ 설치할 컴퓨터 사양 확인 : 제어판→시스템 및 보안→시스템 다운로드 받은 파일을 실행시켜서 프로그램을 설치한다. 이때 password를 입력하는 화면이 나오면 ICON 사에서 받은 password를 입력한다. (그림 2) password를 입력하면 다음과 같이 설치가 자동으로 실행된다. (그림 3) NONMEM 설치가 완료된 후 MPICH2 프로그램 설치여부를 묻는 창이 나오는데 MPICH2 프로그램은 서버 컴퓨터에서 프로그램을 구동할 때 parallel process로 computing 할 때 사용하는 프로그램으로 single core CPU를 사용하는 데스크톱 컴퓨터에서는 사용하지 않으므로 설치하지 않아도 된다. 설치가 모두 완료되면 ICON사에서 받은 license.lic 파일을 nm73g 폴더내의 licence 폴더에 저장한다. (그림 4) 라이선스를 갱신할 때는 프로그램을 새로 다운로드 받을 필요 없이 갱신 라이선스 파일을 기존 폴더에 같은 이름으로 덮어씌우면, 자동으로 사용기간이 연장된다. NONMEM이 설치되면 컴퓨터의 c: 폴더 내에 ‘nm73g’ 폴더가 생성되므로, 탐색기에서 nm73g 폴더가 생성되었는지 확인한다. (그림 5) NONMEM이 설치된 후 프로그램이 제대로 작동하는지 확인하기 위해서 도스창에서 nm73g&gt;run 폴더로 이동하여 ‘nmfe73 control5 control5.txt’를 입력하여 프로그램이 구동되면 설치가 제대로 된 것이다. (그림 6) ※ 도스창에서 NONMEM 프로그램 테스트 : 시작 → 검색 → ’cmd’ 입력→ cd nm73g → cd run → nmfe73 control5 control5.txt 입력 NONMEM이 실행되면 라이선스 발급 기관 및 유효기간이 표시되고, 프로그램에 내장되어 있는 예시 모델의 출력 화면이 나타난다. 2.1.2 MacOS에서 설치 내장 압축해제를 사용하지 않고 터미널에서 다음과 같이 입력한다. In the terminal window, type cd Downloads unzip NONMEM7.4.3.zip # password is obtained from IDSSOFTWARE@iconplc.com) cd nm743CD Now proceed to instruction 5 below for the SETUP74 command with the following options: Option cd (source path) should be $HOME/Downloads/nm743CD Option h (NONMEM 7.4 directory) is up to you. $HOME/nm743 is suggested. If gfortran is installed, the command would be as follows: /bin/bash SETUP74 $HOME/Downloads/nm743CD $HOME/nm743 gfortran NONMEM 7.4 will be installed in directory nm743, in the user’s home directory. Any new terminal window that is opened will 2.2 PsN 설치 PsN은 Perl-Speaks-Nonmem의 줄임말로 NONMEM을 이용한 비선형 혼합효과 모델의 개발에 필요한 Perl 모듈과 프로그램을 모아서 조합해 놓은 프로그램이다. PsN은 무료로 사용가능 한 open source 소프트웨어로, PsN 웹사이트에서 다운로드 받아서 설치한다. ※ PsN 다운로드 사이트 : https://uupharmacometrics.github.io/PsN (그림 7) PsN을 설치하기 전에 NONMEM 프로그램과 Perl module이 컴퓨터에 설치되어 있어야 한다. NONMEM의 설치는 앞에서 설명하였고, 윈도우즈 운영체계에서 Perl module의 설치는 다음과 같다. Active Perl을 설치를 위해 다운로드 사이트(http://www.activestate.com/activeperl) 에서 컴퓨터 사양에 맞게 프로그램을 다운로드 하여 실행한다. (그림 8) 설치가 되면 자동적으로 Perl package manager (ppm) 파일이 생성되고 이 파일을 실행하여 PsN에 필요한 다음의 3가지 perl module을 설치한다. (그림 9) MooseX::Params::Validate Math::Random Statistics::Distribution ※ PPM이 깔린 폴더의 경로 중 한글 이름이 있는 경우 실행되지 않을 수 있으므로 이런 경우, 도스창에서 C:&gt;‘set ACTIVEPERL_PPM_HOME=c:/perl/temp’ 입력하여 경로를 지정해 준 후 ’ppm‘을 쳐서 실행한다. NONMEM과 Perl module의 설치가 완료되었으면, PsN 설치를 위해 다운로드받은 PsN 폴더내에 있는 setup 파일을 클릭하여 실행한다. active perl이 제대로 설치되어야 icon이 활성화되어진다. (그림 10) 파일을 클릭하면 도스창이 열리고 화면 지시대로 진행하면 프로그램이 자동으로 설치된다. Perl Module을 확인하겠냐는 질문이 나오면, y를 입력하여 module이 잘 설치되었는지 확인한다. (그림 11) Perl module이 제대로 설치되지 않았으면 다음과 같이 module missing 메시지를 안내한다. 이런 경우 해당 module이 설치되지 않았으므로, perl module을 확인하여 다시 설치한다. (그림 12) 모두 설치가 완료되면 다음과 같이 설치가 성공적으로 이루어졌다는 화면이 나타난다. (그림 13) 2.3 R 및 R studio 설치 R은 통계 프로그램 및 언어로서 다양한 그래픽 환경을 제공하는 강점이 있어서, NONMEM 프로그램의 결과 파일을 그래프로 제공하기 위해 필요하다. R studio는 R을 사용하기 편리하도록 구동해 주는 프로그램이다. R은 무료로 제공되며, R studio는 버전에 따라 무료와 유료가 있으며 데스크 탑 컴퓨터에 사용하는 프로그램은 무료 프로그램을 다운로드 받아서 사용하면 된다. (그림 14) R 다운로드 사이트 : https://cran.r-project.org/bin/windows/base/ R studio 다운로드 사이트 :https://www.rstudio.com/products/rstudio/download 웹사이트에서 다운로드 받은 프로그램 파일을 더블클릭하여 프로그램을 설치한다. 프로그램 설치후 NONMEM 분석에 사용되는 R Package를 다운로드 받아서 설치한다. 주로 사용되는 package 는 xpose4, PK, ggplot2, psych 등이 있다. R Package를 설치하기 위해서는 console 화면이나 좌측상단의 메인보드에 install.packages(“package name”)을 타이핑하여 실행하거나, 우측하단의 Packages 메뉴에서 원하는 package를 선택하여 클릭한다. (그림 15) 2.4 Pirana 설치 Pirana는 NONMEM 분석을 위한 워크벤치(workbench)로 개발되었으며, 모델의 체계적인 관리와 NONMEM과 다른 연동 프로그램인 PsN, Xpose와의 인터페이스를 제공해 준다. 아카데믹 라이선스는 무료이며, 정부기관에서 사용하는 것도 이에 해당한다. 프로그램 설치는 pirana 사이트에서 다운로드 받아서 설치한다. ※ Pirana 다운로드 사이트 : www.pirana-software.com 프로그램을 다운로드 받기 위해서는 라이선스 요청 화면에서 이름, 소속기관, 이메일 주소를 입력하고 라이선스 종류를 “academic” 으로 선택 후 “Submit”을 클릭하면, 설치 프로그램을 다운로드 할 수 있는 사이트로 이동한다. 컴퓨터 사양에 맞는 설치 프로그램을 다운 받는다. (그림 16) 다운로드 받은 설치 프로그램 파일을 클릭하여 설치를 실행한다. (그림 17) 설치 디렉토리를 묻는 창이 나타나면 디폴트로 선택하여 클릭하고, 설치를 완료한다. C:&gt;Program Files&gt;Pirana 폴더가 생성되고 이 폴더 안에 pirana 실행파일이 생성되며, 시작 프로그램에도 pirana 실행 단축아이콘이 생성된다. (그림 18) 2.5 Pirana에 프로그램 연동 Pirana 프로그램과 NONMEM, PsN, R, 문서편집기 등 다른 프로그램을 연동하도록 참조할 수 있는 경로를 지정해 주어야 한다. 먼저 pirana 아이콘을 클릭하여 프로그램을 실행한 후, Pirana settings 화면으로 이동한다(File 메뉴 &gt;Settings 클릭). NONMEM을 연동하기 위하여 다음 그림과 같이 차례대로 클릭한다. (그림 19) NONMEM → 찾기 아이콘 → Nmfe scripts found: C:/nm73g 선택 → Add selected to Pirana 선택 PsN을 클릭하면 psn.conf location에는 자동으로 경로지정이 되어 있으므로, 이 경로를 복사하여 PsN executables location에 붙여넣기로 경로를 지정해 준다. (그림 20) R은 Software integration으로 들어가서 R 설치 경로를 지정한다. 자동으로 R과 R studio가 설치되는 경로가 지정이 되어 있으며, 해당 경로에 프로그램이 실제로 설치되어 있으면 초록색으로 표시된다. (그림 21) "],
["pirana-.html", "3 Pirana를 이용한 집단약동학 모델링 매뉴얼 3.1 기본 모델 구축 3.2 모델 개선 3.3 기본모델 선정 3.4 공변량 스크리닝 3.5 공변량 모델 설계: PsN의 SCM 이용 3.6 Visual predictive check (VPC) 실행 3.7 Goodness of fit (GOF) 작성 3.8 Bootstrap 실행 3.9 시뮬레이션", " 3 Pirana를 이용한 집단약동학 모델링 매뉴얼 Pirana는 모델파일을 복제하거나, 수정하여 모델을 수행한 후, 수행 결과를 손쉽게 확인할 수 있도록 할 수 있게 해 준다(그림 22). 또한 모델 개발 과정 중에 단계적으로 구축한 모델을 체계적으로 관리할 수 있는 작업공간을 제공해 주며, VPC 및 bootstraping 등의 기능도 수행할 수 있으므로, 특히 모델 구축 경험이 적은 사용자에게 복잡한 프로그램을 좀 더 편리하게 사용할 수 있도록 해 준다. 3.1 기본 모델 구축 기본모델은 대상 의약품의 일반적인 약동학 특성(구획수, 1차흡수, 선형 소실 등)을 설명하고, 개인간 변이와 간단한 잔차 모델 등을 포함하는 기본적인 구조 모델이다. NONMEM으로 기본 모델을 구축하기 위해서 먼저 분석에 사용할 데이터 셋을 구성하여 csv 파일 형태로 저장하고, 메모장이나 문서편집 프로그램을 이용해서 기본 모델 파일을 만든다. 기본 모델은 Control stream의 서식으로 작성되며, 그 구성은 다음과 같다(표 1). 모델 파일은 확장자를 .mod 또는 .ctl로 저장하여야 NONMEM이나 Pirana에서 모델 파일로 인식할 수 있다. 본 책자에서는 프로그램의 구축 및 구동에 대한 내용에 중점을 두어 설명하므로, 데이터 셋 작성 및 모델 파일의 Control stream 각 항목의 세부적인 내용은 2013년도에 발간된 “약물계량학을 활용한 집단약동학 분석과 시뮬레이션 SOP” 또는 “NONMEM Users Guide V”를 참조할 것을 권장한다. Pirana에서 NONMEM을 구동하기 위해서 우선 Pirana를 실행하여 작업 화면으로 들어간다. 찾기 버튼을 눌러 모델 파일(.mod 또는 .ctl)과 데이터 파일(.csv)이 들어 있는 폴더를 선택한다. 이 때 모델파일과 데이터 파일은 같은 폴더 안에 위치해야 한다. 모델을 구동하는 방법은 해당 모델 파일을 선택 후 마우스 우클릭하여, NONMEM⟶nmfe73를 실행 하거나 PsN⟶execute를 실행한다. 또는 해당 모델 파일을 선택하여 메뉴에 있는 NONMEM 실행 단축 아이콘과 PsN 단축 아이콘을 클릭한다. (그림 23) NONMEM이 실행되면 도스창이 나타나면서 실행 결과가 화면에 표시된다. 화면 상단에 Iteration No와 Objective Function Value(Objective value)가 표시되고, 매 Iteration 시마다 추정된 파라미터의 추정값과 Gradient가 화면에 나타나며, 최종 추정이 완료되면 “All runs finished / submitted” 메시지와 estimation, covariance에 걸린 시간이 초단위로 표시된다. (그림 24) Pirana에서 모델 수행 결과를 확인하기 위해서는 새로고침 아이콘()을 누르면 수행한 모델의 결과가 반영되어 화면에 도출된다. Pirana에서는 모델의 수행 결과의 성공여부 및 오류상태를 알파벳 기호로 나타내며, 각 기호의 의미는 다음과 같다. (표 2) 기본 모델 수행 결과가 S와 C가 나타나면 오류없이 모델의 최적화가 이루어졌다고 볼 수 있다. 모델의 결과를 확인하기 위하여 다음과 같이 해당 모델의 우클릭 후 ⟶ model ⟶ parameter estimates 를 클릭한다. 또는 모델 클릭 후 ⟶ 왼쪽 상단의 표 모양 아이콘() 클릭한다 (그림 25). 여러 모델을 같이 클릭하면 각 모델의 추정값을 같이 비교하여 볼 수도 있다 (그림 26). 또는 pirana 창의 오른쪽 Estimates 탭에서 집단대표값(THETA), 개인간 변이(OMEGA) 및 개체내 변이(SIGMA)의 추정값을 확인할 수 있다. 데이터 셋이나 모델 수행으로 생성된 결과의 데이터를 검토해 보고자 하는 경우에 다음과 같이 모델의 우클릭 ⟶ model ⟶ “open data inspector” 클릭 ⟶ 보고자 하는 자료 클릭하거나, 모델 클릭 ⟶ 왼쪽 상단의 그래프 모양 아이콘 () 클릭 ⟶ 보고자 하는 자료 클릭한다. (그림 27, 28) 3.2 모델 개선 최적의 기본 모델을 구축하기 위해서는 비교적 단순한 모델에서 시작해서 점차 다양한 약동학적 파라미터를 추가하여 모델이 개선되는 정도를 비교하게 된다. 기존 모델 수행 결과를 토대로 모델의 일부를 수정하거나 변수를 추가 하여 보다 복잡한 모델을 단계적으로 구축해 나간다. 기존 모델을 토대로 수정된 모델을 만들고자 할 때, 기존 모델을 선택한 후 마우스 오른쪽 버튼으로 File actions → Duplicate를 클릭하거나 복사 단축 아이콘()을 클릭 하여 “Duplicate” 선택한다(그림 29). 이때 기존 모델은 Reference model이 되고, reference model의 추정값을 새로 만드는 모델의 초기값으로 반영하려면, “Use final parameter estimates from reference model” 항목에 체크한다. 3.3 기본모델 선정 데이터 셋을 가장 잘 설명하는 기본 모델을 선정하기 위해 OFV(Objective Function Value, 목적함수값)와 VPC(Visual Predictive Check) 등의 여러 가지 방법을 복합적으로 사용하여 평가할 수 있다. OFV는 데이터에 대한 모델의 적합도를 수치화한 것으로, 하나의 파라미터가 추가될 때 OFV가 3.84 이상 감소한다면 파라미터가 추가된 모델이 데이터에 대해 통계적으로 유의하게 적합하다는 것을 뜻한다. (그림 30) VPC는 시뮬레이션에 기반한 방법으로 모델이 데이터 셋을 적절히 반영할 경우에 시뮬레이션된 데이터가 원래의 데이터와 분포 특징이 비슷하게 나타난다. VPC 수행 방법은 이 메뉴얼의 “6. VPC 실행”에서 설명하고 있다. (그림 31) 이 외에도 GOF(Goodness of fit) plot으로 모델의 적합성을 판단할 수 있다. 관측값(DV)과 예측값(PRED)간의 관계를 나타내는 그래프, 시간 및 예측값(PRED) 대 가중잔차(WRES)와 조건부가중잔차(CWRES) 그래프를 통해 모델을 평가할 수 있다. (그림 32) 3.4 공변량 스크리닝 기본 모델을 선정한 후에 약동학에 영향을 미치는 공변량을 추가하여 데이터 셋을 보다 잘 설명하고, 집단간의 약동학 차이를 규명하기 위한 공변량 모델을 구축한다. 공변량이 어떤 약동학 파라미터에 영향을 미치는지 탐색을 위해 우선 탐색 대상이 되는 공변량들 간의 관계를 파악하는 것이 필요하다. 모델 파일에 $TABLE 블록을 사용하여 관심 대상인 parameter와 ETA 및 대상 공변량을 표 형태의 결과물로 출력해 낸 후 R을 이용하여 상관관계를 분석할 수 있다. (표 3) $TABLE을 활용하여 표를 생성하면 파일의 확장자가 지정되어 있지 않으므로 파일을 엑셀로 실행한 후에 첫 줄을 지우고, 첫 행을 블록 지정하여 ‘데이터 ⟶ 텍스트나누기 ⟶ 너비가 일정함’으로 행을 나눈 후에 .csv 확장자로 저장한다. (그림 33) Pirana에서 모델 실행하면 표 형식의 결과 파일이 생성되므로, Pirana Files ⟶ 해당 모델의 run number 우클릭 → Open in → R gui를 차례대로 클릭하면 R studio 창이 열리고, 여기에서 R code 블록 지정 ⟶ Run → console 창에서 ‘6(Covariate model)’ 입력 및 Enter → ‘4(Parameter vs covariates)’ 입력 및 Enter 한 후 Plot 창에서 결과를 확인할 수 있다 (그림 34, 35). 다음으로 R package인 “psych”, “ggplot2” 등을 이용하여 여러 변수들 간의 관계를 비교할 수 있다. “psych”를 사용하여 연속형 변수 간의 상관관계 그래프와 상관계수를 산출할 수 있으며, “psych”를 이용하여 코딩한 R 파일의 예시와 실행 후의 결과 그래프는 다음과 같다 (표 4, 그림 36). “ggplot2”의 경우는 범주형 변수에 따른 연속형 변수의 분포를 시각화하는데 사용할 수 있다. R package “ggplot2”를 이용하여 코딩한 R 파일의 예시와 실행 후의 결과 그래프는 다음과 같다 (표 5, 그림 37). 이러한 공변량 스크리닝 과정을 통해, 어떤 공변량이 어떤 파라미터에 영향을 미칠 것인지 미리 탐색해 볼 수 있으며, 이후의 공변량 테스트 과정에서 서로 상관관계가 있는 공변량을 중복하여 테스트 하는 것을 방지할 수 있다. 3.5 공변량 모델 설계: PsN의 SCM 이용 공변량의 체계적인 평가와 선택을 위한 방법 중 하나로 전진선택법(forward selection)으로 공변량을 단계적으로 추가한 뒤 후진제거법(backward elimination)으로 유효하지 않은 공변량을 제거해 나가는 방법이 있다. Pirana에서 PsN의 SCM(Stepwise Covariate Modeling)을 이용하여 수행할 수 있다. 전진선택에서는 공변량을 모델에 한 개씩 추가하여 각각의 공변량 효과를 각각의 파라미터에 대해 평가하는 것이다. 후진제거의 경우, 각 공변량 효과를 한 번에 하나씩 모델로부터 제거하면서 평가를 수행한다. Pirana에서 SCM을 수행하기 위해서는 configuration file을 만들어 데이터 셋 및 모델파일과 동일한 폴더내에 저장하여야 한다. Configuration fie의 예시는 표 6에 나타내었으며, 확장자가 .scm 이어야 pirana에서 인식 가능하다. Pirana에서 대상 모델을 우클릭한 후 PsN, Covariates, SCM을 차례대로 클릭하면 PsN Toolkit(scm) 창이 열리고, SCM config file이 제대로 선택되었는지 확인하고 실행버튼을 클릭한다. (그림 38, 39) SCM 수행 후 scmlog 파일을 메모장 또는 엑셀로 실행하면 SCM 과정과 결과를 확인할 수 있다. (그림 40) 3.6 Visual predictive check (VPC) 실행 VPC는 모델을 기반으로 시뮬레이션 할 데이터 셋을 생성하여 대상 모델에 적용한 결과와 실제 관측 데이터를 비교하여 모델을 진단하는 방법으로 하나의 그래프에 예측된 혈중농도와 관측된 혈중농도를 겹쳐 그려 모델의 적합성을 확인할 수 있다. VPC를 실행하기 위해 대상 모델을 우클릭 후, PsN, Model diagnostics, vpc를 차례대로 클릭한다(그림 41). PsN Toolkit (vpc) 창이 열리고, 이 때 PsN command line에서 VPC 실행을 위한 옵션을 지정한 후 VPC를 수행한다. (표 7, 그림 42) VPC 수행 후 PsN_vpc_plots.R 파일을 실행하거나 R studio를 이용하여 VPC plot을 확인할 수 있다. 먼저 PsN command line에서 지정한 폴더에서 PsN_vpc_plots.R 파일을 실행하면 R studio 로 연결된다(그림 43). R studio에서 왼쪽 상단의 script를 모두 블록 지정하여 Run 클릭하면 같은 폴더내에 VPC plot이 .pdf 파일로 생성된다. (그림 44) 또는 VPC 결과 파일이 생성된 후 R studio 프로그램을 실행 하여 표 8의 R code를 입력하고 실행하면 VPC 그래프가 생성된다. Plots ⟶ Export ⟶ “Save as Image” 또는 “Save as PDF” 선택하면 VPC plot을 파일로 저장 할 수 있다. (그림 45) VPC plot에서 실선은 혈중농도 예측치의 중위수, 위·아래의 점선은 각각 5번째와 95번째 백분위수의 값을 나타내고, 빨간색 음영은 예측치 중위수의 95% 신뢰구간, 파란색 음영은 각각 5번째, 95번째 백분위수의 95% 신뢰구간을 나타낸다. 원형의 점들은 혈중농도 관측치를 나타낸다. 3.7 Goodness of fit (GOF) 작성 GOF는 집단예측값과 개인예측값을 실제 관측값과 비교하거나 가중잔차 대 예측값의 산점도 등을 통해 모델의 적합성을 확인할 수 있다. Pirana에서 모델 수행 후에 얻어진 결과 파일을 이용하여 pirana에서 제공하는 메뉴를 이용하거나 직접 R 프로그램에서 GOF를 실행할 수 있다. 직접적으로 pirana를 이용하는 방법으로 pirana 오른쪽 상단 “scripts” 탭 클릭 ⟶ Basic_GOF 활성화 → 원하는 GOF plot을 더블 클릭하여 pdf 파일로 얻을 수 있다. (그림 46) 또는 모델 파일에 $TABLE 작성하여 결과 표 생성 확인 후 pirana 오른쪽 상단 “Files” 탭 클릭 → “xpose” 입력 → 대상 모델 우클릭 → Open in → R GUI → R studio와 연동되어 R 코드 생성 → 전체 블록지정 후 Run → R studio의 오른쪽 하단 Plots → Export → “Save as Image” 또는 “Save as PDF” 선택하면 VPC plot이 파일로 생성된다. (그림 47) R 프로그램에서 실행하는 방법은 모델 파일에 $TABLE 작성하여 결과 표 생성되었는지 확인한 후에 R package “ggplot2”을 이용하여 GOF plot을 그릴 수 있다. 이 방법을 사용하면 GOF의 디자인 맞춤화가 가능하다는 것이 장점이다. (표 9, 그림 48) 3.8 Bootstrap 실행 Bootstrap은 대상 모델의 데이터 셋으로부터 N개의 새로운 데이터 셋을 복원추출하여 생성한 다음 생성된 데이터 셋을 모델에 적합 시키는 방법이다. pirana에서 실행하는 방법은 대상 모델을 우클릭 한 후 PsN, Model diagnostics, bootstrap을 순서대로 클릭한다(그림 49). PsN Toolkit (bootstrap)이 뜨면 PsN command line에 있는 옵션을 조절하여 bootstrap를 수행한다(표 10, 그림 50) ※ PsN command line(default)는 아래와 같음 Bootstrap의 결과는 지정된 폴더 내의 “bootstrap_results.csv” 파일로 저장 되며, 대상 모델의 약동학 파라미터 추정값과 bootstrap을 통해 도출된 파라미터의 중앙값과 95% 예측구간(5∼95th percentile)과 데이터 셋의 수렴율을 확인할 수 있다. (그림 51) 3.9 시뮬레이션 시뮬레이션은 개발한 모델을 다양한 시나리오에 적용하여 결과를 예측하기 위해 수행한다. 시뮬레이션을 수행하기 위해 대상 모델과 모델을 적용할 새로운 시나리오가 반영된 데이터 셋이 필요하다. 시뮬레이션을 실시하고자 하는 시나리오에 해당하는 데이터 셋을 아래와 같이 R 코드를 이용하여 생성할 수 있으며(표 11), R 코드를 실행하면 확장자가 csv인 데이터 셋이 생성된다. 이 데이터 셋은 기존 모델에 사용하는 데이터 셋과 달리 DV 값을 제거하여 시뮬레이션의 결과로 DV가 추정될 수 있도록 해야 한다. (그림 52) 시뮬레이션을 위한 모델은 다음의 모델 예시와 같이 theta, eta, sigma 값이 최종 모델의 추정 값으로 고정되어야 하며, 모델링 시엔 파라미터 추정을 위해 $ESTIMATION 블록과 $COVARIANCE 블록을 사용하였으나 시뮬레이션 시 두 블록 대신 \\(SIMULATION(\\)SIM) 블록을 사용한다. 또한 시뮬레이션 수행 결과를 R로 불러와서 통계분석을 하거나 그래프를 그릴 수 있도록 $TABLE을 활용하여 표를 생성한다. (표 12) 데이터 셋과 모델이 생성되면 시뮬레이션을 수행할 수 있다. Pirana에서 시뮬레이션 대상 모델을 클릭한 후 왼쪽 위의 복제(duplicate) 아이콘을 클릭하면 Duplicate 창이 뜨고, 3가지 옵션에 체크하면 시뮬레이션을 위한 모델이 생성된다. 생성된 모델을 우클릭하여 NONMEM(→nmfe) 또는 PsN(→execute)으로 실행할 수 있다. (그림 53) 시뮬레이션 실행 후 생성된 표를 활용하여 R package “PK” 혹은 “NonCompart”를 이용하여 NCA(Non-compartmental analysis, 비구획분석)를 할 수 있으며, 그 결과 AUC, MRT, T1/2, Vd, Cmax, Tmax를 구할 수 있다. (표 13, 표 14) R package “ggplot2”을 이용하여 시뮬레이션 예측값의 5, 50, 95번째 백분위수에 대한 그래프를 그릴 수 있으며, 한 plot 안에 여러 가지 시나리오 그래프도 그릴 수 있다. 아래에 각각의 R 코드 예시를 보여주고 있다. (표 14, 15 및 그림 54, 55) "],
["section-4.html", "4 참고문헌", " 4 참고문헌 A. J. Boeckmann, et al. NONMEM Users Guide-Part Ⅴ, 2013 Pirana Installation guide and manual, March 29, 2015 PsN installation, http://uupharmacometrics.github.io/PsN/install.html SCM user guide, revised 2016-09-06 VPC and NPC user guide, revised 2017-02-23 Bootstrap user guide, revised 2016-05-30 Package ‘Xpose4’ user guide, revised 2017-06-17 약물계량학을 활용한 집단약동학 분석과 시뮬레이션 SOP, March, 2013 "]
]
